import init.m86.usb.rc

on init

    export LD_SHIM_LIBS "/system/lib64/hw/hwcomposer.exynos5.so|libshim_media.so:/system/lib/hw/audio.primary.m86.so|/system/lib/libshim_media.so:/system/lib/libexynoscamera.so|/system/lib/libshim_media.so:/system/bin/gpsd|libgps_shim.so"

    # Directory for mount custom partition
    mkdir /custom 0555 root root

    symlink /sdcard /mnt/sdcard
    symlink /sdcard /storage/sdcard0

on post-fs-data
    mkdir /data/media 0770 media_rw media_rw

    # permissions for bluetooth.
    #setprop ro.bt.bdaddr_path "/factory/bluetooth/bt_addr"
    mkdir /factory/bluetooth 0771 bluetooth bluetooth
    chown bluetooth net_bt_stack ro.bt.bdaddr_path
    chown bluetooth net_bt_stack /dev/ttySAC4
    chmod 0660 /dev/ttySAC4
    chmod 0660 /sys/class/rfkill/rfkill0/state
    chown bluetooth net_bt_stack /sys/class/rfkill/rfkill0/state
    chown bluetooth net_bt_stack /sys/class/rfkill/rfkill0/type

    # permissions for wifi
    mkdir /data/misc/dhcp 0770 dhcp dhcp
    mkdir /data/misc/wifi 0770 wifi wifi
    mkdir /data/misc/wifi/sockets 0770 wifi wifi

    # for calibration data persistence
    mkdir /data/calibration
    chown wifi wifi /data/calibration
    chmod 0771 /data/calibration

    #mobicore
    mkdir /data/app/mcRegistry 0770 system system

    setprop vold.post_fs_data_done 1

#for GPS
    chown gps system /dev/ttySAC1
    chmod 0660 /dev/ttySAC1
    chown gps system /sys/class/misc/gps/device/pwr
    chmod 0770 /sys/class/misc/gps/device/pwr
    mkdir /data/gps 0770 gps system

on boot
    mount debugfs /sys/kernel/debug /sys/kernel/debug

    # Allow to access debugfs for system:system
    chown system system /sys/kernel/debug
    chmod 0755 /sys/kernel/debug
    #allow access to fake temperature for system:system
    chmod 0644 /sys/class/battery_class/battery_device/fake_temp_enable
    chown system system /sys/class/battery_class/battery_device/fake_temp_enable
    chmod 0644 /sys/class/battery_class/battery_device/fake_temp
    chown system system /sys/class/battery_class/battery_device/fake_temp
    chmod 0666 /sys/class/battery_class/battery_device/fake_cap_enable
    chown system system /sys/class/battery_class/battery_device/fake_cap_enable

    setprop ro.radio.noril no

    # Set up kernel tracing, but disable it by default
    chmod 0222 /sys/kernel/debug/tracing/trace_marker
    write /sys/kernel/debug/tracing/tracing_on 0

    #Change AD mod
    chmod 0660 /sys/devices/13930000.decon_fb/adreg
    chown system system /sys/devices/13930000.decon_fb/adreg

    # Change permission for interactive governor
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_rate
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_rate
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_slack
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/timer_slack
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/min_sample_time
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/min_sample_time
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/hispeed_freq
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/hispeed_freq
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/target_loads
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/go_hispeed_load
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/go_hispeed_load
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/above_hispeed_delay
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/above_hispeed_delay
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/boost
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/boost
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/boostpulse
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/input_boost
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/input_boost
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/boostpulse_duration
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/boostpulse_duration
    chown system system /sys/devices/system/cpu/cpu0/cpufreq/interactive/io_is_busy
    chmod 0660 /sys/devices/system/cpu/cpu0/cpufreq/interactive/io_is_busy

    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_rate
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_rate
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_slack
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/timer_slack
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/min_sample_time
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/min_sample_time
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/hispeed_freq
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/hispeed_freq
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/target_loads
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/target_loads
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/go_hispeed_load
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/go_hispeed_load
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/above_hispeed_delay
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/above_hispeed_delay
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/boost
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/boost
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/input_boost
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/input_boost
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse_duration
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/boostpulse_duration
    chown system system /sys/devices/system/cpu/cpu4/cpufreq/interactive/io_is_busy
    chmod 0660 /sys/devices/system/cpu/cpu4/cpufreq/interactive/io_is_busy

# Permission for USB SELECT
    chown system system /sys/class/android_usb/android0/enable
    chmod 0660 /sys/class/android_usb/android0/enable
    chown system system /sys/class/android_usb/android0/idVendor
    chmod 0660 /sys/class/android_usb/android0/idVendor
    chown system system /sys/class/android_usb/android0/idProduct
    chmod 0660 /sys/class/android_usb/android0/idProduct
    chown system system /sys/class/android_usb/android0/f_diag/clients
    chmod 0660 /sys/class/android_usb/android0/f_diag/clients
    chown system system /sys/class/android_usb/android0/functions
    chmod 0660 /sys/class/android_usb/android0/functions
    chown system system /sys/class/android_usb/android0/bDeviceClass
    chmod 0660 /sys/class/android_usb/android0/bDeviceClass

# Log data folder
    mkdir /data/log 0771 radio system
    mkdir /data/efs 0771 radio system

# Support DM logging
    chmod 0770 /system/bin/dmd

# Support Virtual Com
    chmod 0770 /system/bin/vcd

# Support AP/CP log dump
    chmod 0770 /system/bin/sced

# Camera: modify the FLASH LED permission
    chown media system /sys/class/leds/torch0/brightness
    chown media system /sys/class/leds/torch0/onoff
    chown media system /sys/class/leds/torch1/brightness
    chown media system /sys/class/leds/torch1/onoff
    chown media system /sys/class/leds/torch0/hwen
    chown media system /sys/class/leds/torch0/enable
    chown media system /sys/class/leds/torch1/enable

    chmod 0660 /sys/class/leds/torch0/hwen
    chmod 0660 /sys/class/leds/torch0/onoff
    chmod 0660 /sys/class/leds/torch1/onoff
    chmod 0660 /sys/class/leds/torch0/enable
    chmod 0660 /sys/class/leds/torch1/enable

# NFC: create data/nfc for nv storage
    mkdir /data/nfc 770 nfc nfc
    mkdir /data/nfc/param 770 nfc nfc
    chown nfc nfc /dev/pn544
    chmod 0660 /dev/pn544
    chown nfc nfc /dev/p61
    chmod 0660 /dev/p61
    mkdir /data/smartmx 777 system system
    setprop ro.nfc.platform nxppn547

    
    #tmd27713
    chown system system /sys/class/input/input0/device/enable_als
    chmod 0600 /sys/class/input/input0/device/enable_als
    chown system system /sys/class/input/input0/device/enable_ps
    chmod 0600 /sys/class/input/input0/device/enable_ps

    ## Invensense IIO settings
    # folders
    chown system system /sys/bus/iio/devices/iio:device1/
    chmod 0700           /sys/bus/iio/devices/iio:device1/
    chown system system /sys/bus/iio/devices/iio:device1/power
    chmod 0700           /sys/bus/iio/devices/iio:device1/power
    chown system system /sys/bus/iio/devices/iio:device1/buffer
    chmod 0700           /sys/bus/iio/devices/iio:device1/buffer
    chown system system /sys/bus/iio/devices/iio:device1/trigger
    chmod 0700           /sys/bus/iio/devices/iio:device1/trigger
    chown system system /sys/bus/iio/devices/iio:device1/scan_elements
    chmod 0700           /sys/bus/iio/devices/iio:device1/scan_elements

# mediaserver cache machanism
    mkdir /data/mediaserver 0771 media media
    chown media media /data/mediaserver
    chmod 0771 /data/mediaserver

# permission for sensor hub
    chown system system /sys/class/meizu/mx_hub/batch
    chmod 0660 /sys/class/meizu/mx_hub/batch
    chown system system /sys/class/meizu/mx_hub/calibrator_cmd
    chmod 0660 /sys/class/meizu/mx_hub/calibrator_cmd
    chown system system /sys/class/meizu/mx_hub/calibrator_data
    chmod 0660 /sys/class/meizu/mx_hub/calibrator_data
    chown system system /sys/class/meizu/mx_hub/enable
    chmod 0660 /sys/class/meizu/mx_hub/enable
    chown system system /sys/class/meizu/mx_hub/firmware_update_cmd
    chmod 0664 /sys/class/meizu/mx_hub/firmware_update_cmd
    chown system system /sys/class/meizu/mx_hub/firmware_update_data
    chmod 0664 /sys/class/meizu/mx_hub/firmware_update_data
    chown system system /sys/class/meizu/mx_hub/firmware_update_i2c
    chmod 0664 /sys/class/meizu/mx_hub/firmware_update_i2c
    chown system system /sys/class/meizu/mx_hub/firmware_update_status
    chmod 0664 /sys/class/meizu/mx_hub/firmware_update_status
    chown system system /sys/class/meizu/mx_hub/flush
    chmod 0660 /sys/class/meizu/mx_hub/flush
    chown system system /sys/class/meizu/mx_hub/mcu_mode
    chmod 0660 /sys/class/meizu/mx_hub/mcu_mode
    chown system system /sys/class/meizu/mx_hub/power
    chmod 0660 /sys/class/meizu/mx_hub/power
    chown system system /sys/class/meizu/mx_hub/raw_data0
    chmod 0660 /sys/class/meizu/mx_hub/raw_data0
    chown system system /sys/class/meizu/mx_hub/raw_data1
    chmod 0660 /sys/class/meizu/mx_hub/raw_data1
    chown system system /sys/class/meizu/mx_hub/raw_data2
    chmod 0660 /sys/class/meizu/mx_hub/raw_data2
    chown system system /sys/class/meizu/mx_hub/raw_data3
    chmod 0660 /sys/class/meizu/mx_hub/raw_data3
    chown system system /sys/class/meizu/mx_hub/raw_data4
    chmod 0660 /sys/class/meizu/mx_hub/raw_data4
    chown system system /sys/class/meizu/mx_hub/sys_cmd
    chmod 0660 /sys/class/meizu/mx_hub/sys_cmd
    chown system system /sys/class/meizu/mx_hub/timestamp
    chmod 0660 /sys/class/meizu/mx_hub/timestamp
    chown system system /sys/class/meizu/mx_hub/uevent
    chmod 0660 /sys/class/meizu/mx_hub/uevent
    chown system system /sys/class/meizu/mx_hub/version
    chmod 0444 /sys/class/meizu/mx_hub/version
    chown system system /sys/class/meizu/mx_hub/mag_special_data
    chmod 0660 /sys/class/meizu/mx_hub/mag_special_data
    chown system system /sys/class/meizu/mx_hub/iio
    chown system system /sys/class/meizu/mx_hub/subsystem
    chown system system /sys/bus/iio/devices/iio:device0/buffer/length
    chown system system /sys/bus/iio/devices/iio:device0/buffer/enable
    chown system system /sys/bus/iio/devices/iio:device0/trigger/current_trigger
    chown system system /sys/bus/iio/devices/trigger0/name
    chmod 0664 /sys/bus/iio/devices/iio:device0/buffer/length
    chmod 0664 /sys/bus/iio/devices/iio:device0/buffer/enable
    chmod 0664 /sys/bus/iio/devices/iio:device0/trigger/current_trigger
    chmod 0660 /sys/bus/iio/devices/trigger0/name
    chown system system /dev/iio:device0
    chmod 0600           /dev/iio:device0

#permission for ps sensor
    chown system system /sys/class/meizu/ps/als_data
    chown system system /sys/class/meizu/ps/ps_calibration
    chown system system /sys/class/meizu/ps/ps_calibbias
    chown system system /sys/class/meizu/ps/ps_offset
    chown system system /sys/class/meizu/ps/ps_flush
    chown system system /sys/class/meizu/ps/ps_gpio
    chown system system /sys/class/meizu/ps/ps_batch
    chown system system /sys/class/meizu/ps/ps_data
    chown system system /sys/class/meizu/ps/ps_enable
    chown system system /sys/class/meizu/ps/ps_reg
    chown system system /sys/class/meizu/ps/ps_wakeup_enable

#permission for ambilight sensor
    chown system system /sys/class/meizu/als/adc_resolution_bits
    chown system system /sys/class/meizu/als/adc_start_sync
    chown system system /sys/class/meizu/als/als_batch
    chown system system /sys/class/meizu/als/cct
    chown system system /sys/class/meizu/als/debug
    chown system system /sys/class/meizu/als/als_flush
    chown system system /sys/class/meizu/als/intr_persistency
    chown system system /sys/class/meizu/als/intr_threshold_assign
    chown system system /sys/class/meizu/als/intr_threshold_high
    chown system system /sys/class/meizu/als/intr_threshold_low
    chown system system /sys/class/meizu/als/lux
    chown system system /sys/class/meizu/als/mode
    chown system system /sys/class/meizu/als/optical_range
    chown system system /sys/class/meizu/als/poll_delay
    chown system system /sys/class/meizu/als/raw_adc
    chown system system /sys/class/meizu/als/als_reg
    chown system system /sys/class/meizu/als/rgb_conv_intr
    chown system system /sys/class/meizu/als/als_enable
    chown system system /sys/class/meizu/als/xy_value

#Permissions for gesture
    chown system system /sys/class/meizu/tp/gesture_control
    chown system system /sys/class/meizu/tp/gesture_data
    chown system system /sys/class/meizu/tp/glove_control
    chmod 0666 /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/dtp_interval

# Fingerprint
    chown system system /dev/fpc1020
    chmod 0770 /dev/fpc1020
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/adc_gain
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/adc_shift
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_col_groups
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_col_start
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_count
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_mode
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_row_count
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_row_start
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/capture_settings_mux
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/enable_navi
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/force_reset
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/gain_shift
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/input_mode
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/orientation
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/pixel_ctrl
    chown system system /sys/devices/14d70000.spi/spi_master/spi4/spi4.0/setup/pxl_ctrl

#Permissions for led
    chown system system /sys/devices/gpioi2c0.14/i2c-12/12-0030/led_pattern
    chown system system /sys/devices/gpioi2c0.14/i2c-12/12-0030/leds/m86_led/brightness
    chmod 0666 /sys/devices/gpioi2c0.14/i2c-12/12-0030/led_pattern
    chmod 0666 /sys/devices/gpioi2c0.14/i2c-12/12-0030/leds/m86_led/brightness

#Permission for power mode
    chown system system /sys/power/power_mode
    chmod 0660 /sys/power/power_mode

#Permission for margin control
    chown system system /sys/class/meizu/tp/margin_control
    chmod 0660 /sys/class/meizu/tp/margin_control
    chown system system /sys/class/meizu/tp/margin_control_test
    chmod 0660 /sys/class/meizu/tp/margin_control_test

    # Permission for dis effect
    chmod 0666 /sys/devices/13930000.decon_fb/scr
    chown system shell /sys/devices/13930000.decon_fb/scr
    chmod 0666 /sys/devices/13930000.decon_fb/cont
    chown system shell /sys/devices/13930000.decon_fb/cont
    chmod 0666 /sys/devices/13930000.decon_fb/hue
    chown system shell /sys/devices/13930000.decon_fb/hue
    chmod 0666 /sys/devices/13930000.decon_fb/sat
    chown system shell /sys/devices/13930000.decon_fb/sat
    chmod 0444 /sys/devices/13930000.decon_fb/con_reg
    chown system shell /sys/devices/13930000.decon_fb/con_reg
    chmod 0666 /sys/devices/13930000.decon_fb/ctrl_reg
    chown system shell /sys/devices/13930000.decon_fb/ctrl_reg
    chmod 0222 /sys/devices/13930000.decon_fb/bri
    chown system shell /sys/devices/13930000.decon_fb/bri

    # files
    chown system system /dev/iio:device1
    chmod 0600           /dev/iio:device1
    chown system system /sys/bus/iio/devices/iio:device1/dev
    chmod 0600           /sys/bus/iio/devices/iio:device1/dev
    chown system system /sys/bus/iio/devices/iio:device1/name
    chmod 0600           /sys/bus/iio/devices/iio:device1/name
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_counter
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_counter
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_x_calibbias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_x_calibbias
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_y_offset
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_y_offset
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_x_calibbias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_x_calibbias
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_time
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_time
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_steps
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_steps
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_scale
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_scale
    chown system system /sys/bus/iio/devices/iio:device1/self_test
    chmod 0600           /sys/bus/iio/devices/iio:device1/self_test
    chown system system /sys/bus/iio/devices/iio:device1/power/control
    chmod 0600           /sys/bus/iio/devices/iio:device1/power/control
    chown system system /sys/bus/iio/devices/iio:device1/power/runtime_active_time
    chmod 0600           /sys/bus/iio/devices/iio:device1/power/runtime_active_time
    chown system system /sys/bus/iio/devices/iio:device1/power/autosuspend_delay_ms
    chmod 0600           /sys/bus/iio/devices/iio:device1/power/autosuspend_delay_ms
    chown system system /sys/bus/iio/devices/iio:device1/power/runtime_status
    chmod 0600           /sys/bus/iio/devices/iio:device1/power/runtime_status
    chown system system /sys/bus/iio/devices/iio:device1/power/runtime_suspended_time
    chmod 0600           /sys/bus/iio/devices/iio:device1/power/runtime_suspended_time
    chown system system /sys/bus/iio/devices/iio:device1/ped_q_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/ped_q_rate
    chown system system /sys/bus/iio/devices/iio:device1/event_accel_motion
    chmod 0600           /sys/bus/iio/devices/iio:device1/event_accel_motion
    chown system system /sys/bus/iio/devices/iio:device1/pressure_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/pressure_enable
    chown system system /sys/bus/iio/devices/iio:device1/step_detector_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/step_detector_on
    chown system system /sys/bus/iio/devices/iio:device1/compass_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/compass_enable
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_x_dmp_bias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_x_dmp_bias
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_x_dmp_bias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_x_dmp_bias
    chown system system /sys/bus/iio/devices/iio:device1/self_test_samples
    chmod 0600           /sys/bus/iio/devices/iio:device1/self_test_samples
    chown system system /sys/bus/iio/devices/iio:device1/sampling_frequency
    chmod 0600           /sys/bus/iio/devices/iio:device1/sampling_frequency
    chown system system /sys/bus/iio/devices/iio:device1/gyro_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/gyro_rate
    chown system system /sys/bus/iio/devices/iio:device1/smd_threshold
    chmod 0600           /sys/bus/iio/devices/iio:device1/smd_threshold
    chown system system /sys/bus/iio/devices/iio:device1/compass_matrix
    chmod 0600           /sys/bus/iio/devices/iio:device1/compass_matrix
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_self_test_scale
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_self_test_scale
    chown system system /sys/bus/iio/devices/iio:device1/motion_lpa_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/motion_lpa_on
    chown system system /sys/bus/iio/devices/iio:device1/smd_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/smd_enable
    chown system system /sys/bus/iio/devices/iio:device1/smd_delay_threshold2
    chmod 0600           /sys/bus/iio/devices/iio:device1/smd_delay_threshold2
    chown system system /sys/bus/iio/devices/iio:device1/accel_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/accel_enable
    chown system system /sys/bus/iio/devices/iio:device1/firmware_loaded
    chmod 0600           /sys/bus/iio/devices/iio:device1/firmware_loaded
    chown system system /sys/bus/iio/devices/iio:device1/six_axes_q_value
    chmod 0600           /sys/bus/iio/devices/iio:device1/six_axes_q_value
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_x_offset
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_x_offset
    chown system system /sys/bus/iio/devices/iio:device1/six_axes_q_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/six_axes_q_rate
    chown system system /sys/bus/iio/devices/iio:device1/accel_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/accel_rate
    chown system system /sys/bus/iio/devices/iio:device1/accel_matrix
    chmod 0600           /sys/bus/iio/devices/iio:device1/accel_matrix
    chown system system /sys/bus/iio/devices/iio:device1/gyro_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/gyro_enable
    chown system system /sys/bus/iio/devices/iio:device1/secondary_name
    chmod 0600           /sys/bus/iio/devices/iio:device1/secondary_name
    chown system system /sys/bus/iio/devices/iio:device1/event_smd
    chmod 0600           /sys/bus/iio/devices/iio:device1/event_smd
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_y_dmp_bias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_y_dmp_bias
    chown system system /sys/bus/iio/devices/iio:device1/buffer/enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/buffer/enable
    chown system system /sys/bus/iio/devices/iio:device1/buffer/length
    chmod 0600           /sys/bus/iio/devices/iio:device1/buffer/length
    chown system system /sys/bus/iio/devices/iio:device1/sampling_frequency_available
    chmod 0600           /sys/bus/iio/devices/iio:device1/sampling_frequency_available
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_y_dmp_bias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_y_dmp_bias
    chown system system /sys/bus/iio/devices/iio:device1/six_axes_q_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/six_axes_q_on
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_x_offset
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_x_offset
    chown system system /sys/bus/iio/devices/iio:device1/event_pedometer
    chmod 0600           /sys/bus/iio/devices/iio:device1/event_pedometer
    chown system system /sys/bus/iio/devices/iio:device1/dmp_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/dmp_on
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_self_test_scale
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_self_test_scale
    chown system system /sys/bus/iio/devices/iio:device1/gyro_fifo_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/gyro_fifo_enable
    chown system system /sys/bus/iio/devices/iio:device1/batchmode_wake_fifo_full_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/batchmode_wake_fifo_full_on
    chown system system /sys/bus/iio/devices/iio:device1/motion_lpa_threshold
    chmod 0600           /sys/bus/iio/devices/iio:device1/motion_lpa_threshold
    chown system system /sys/bus/iio/devices/iio:device1/master_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/master_enable
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_z_calibbias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_z_calibbias
    chown system system /sys/bus/iio/devices/iio:device1/gyro_matrix
    chmod 0600           /sys/bus/iio/devices/iio:device1/gyro_matrix
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_z_calibbias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_z_calibbias
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_on
    chown system system /sys/bus/iio/devices/iio:device1/trigger/current_trigger
    chmod 0600           /sys/bus/iio/devices/iio:device1/trigger/current_trigger
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_z_offset
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_z_offset
    chown system system /sys/bus/iio/devices/iio:device1/temperature
    chmod 0600           /sys/bus/iio/devices/iio:device1/temperature
    chown system system /sys/bus/iio/devices/iio:device1/three_axes_q_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/three_axes_q_on
    chown system system /sys/bus/iio/devices/iio:device1/dmp_event_int_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/dmp_event_int_on
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_z_offset
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_z_offset
    chown system system /sys/bus/iio/devices/iio:device1/smd_delay_threshold
    chmod 0600           /sys/bus/iio/devices/iio:device1/smd_delay_threshold
    chown system system /sys/bus/iio/devices/iio:device1/pressure_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/pressure_rate
    chown system system /sys/bus/iio/devices/iio:device1/uevent
    chmod 0600           /sys/bus/iio/devices/iio:device1/uevent
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_z_dmp_bias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_z_dmp_bias
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_z_dmp_bias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_z_dmp_bias
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_int_thresh
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_int_thresh
    chown system system /sys/bus/iio/devices/iio:device1/ped_q_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/ped_q_on
    chown system system /sys/bus/iio/devices/iio:device1/accel_fifo_enable
    chmod 0600           /sys/bus/iio/devices/iio:device1/accel_fifo_enable
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_step_thresh
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_step_thresh
    chown system system /sys/bus/iio/devices/iio:device1/compass_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/compass_rate
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_y_calibbias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_y_calibbias
    chown system system /sys/bus/iio/devices/iio:device1/flush_batch
    chmod 0600           /sys/bus/iio/devices/iio:device1/flush_batch
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_y_calibbias
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_y_calibbias
    chown system system /sys/bus/iio/devices/iio:device1/dmp_int_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/dmp_int_on
    chown system system /sys/bus/iio/devices/iio:device1/in_magn_scale
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_magn_scale
    chown system system /sys/bus/iio/devices/iio:device1/batchmode_timeout
    chmod 0600           /sys/bus/iio/devices/iio:device1/batchmode_timeout
    chown system system /sys/bus/iio/devices/iio:device1/dmp_firmware
    chmod 0600           /sys/bus/iio/devices/iio:device1/dmp_firmware
    chown system system /sys/bus/iio/devices/iio:device1/step_indicator_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/step_indicator_on
    chown system system /sys/bus/iio/devices/iio:device1/scan_elements/in_timestamp_type
    chmod 0600           /sys/bus/iio/devices/iio:device1/scan_elements/in_timestamp_type
    chown system system /sys/bus/iio/devices/iio:device1/scan_elements/in_timestamp_index
    chmod 0600           /sys/bus/iio/devices/iio:device1/scan_elements/in_timestamp_index
    chown system system /sys/bus/iio/devices/iio:device1/scan_elements/in_timestamp_en
    chmod 0600           /sys/bus/iio/devices/iio:device1/scan_elements/in_timestamp_en
    chown system system /sys/bus/iio/devices/iio:device1/power_state
    chmod 0600           /sys/bus/iio/devices/iio:device1/power_state
    chown system system /sys/bus/iio/devices/iio:device1/motion_lpa_freq
    chmod 0600           /sys/bus/iio/devices/iio:device1/motion_lpa_freq
    chown system system /sys/bus/iio/devices/iio:device1/self_test_threshold
    chmod 0600           /sys/bus/iio/devices/iio:device1/self_test_threshold
    chown system system /sys/bus/iio/devices/iio:device1/in_anglvel_scale
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_anglvel_scale
    chown system system /sys/bus/iio/devices/iio:device1/in_accel_y_offset
    chmod 0600           /sys/bus/iio/devices/iio:device1/in_accel_y_offset
    chown system system /sys/bus/iio/devices/iio:device1/reg_dump
    chmod 0600           /sys/bus/iio/devices/iio:device1/reg_dump
    chown system system /sys/bus/iio/devices/iio:device1/three_axes_q_rate
    chmod 0600           /sys/bus/iio/devices/iio:device1/three_axes_q_rate
    chown system system /sys/bus/iio/devices/iio:device1/pedometer_int_on
    chmod 0600           /sys/bus/iio/devices/iio:device1/pedometer_int_on

    # Aricent Integration [START]
    #aricent system prop
    # Aricent IMS service will load liraries from /system/lib
    setprop aricent_ims_type 1
    # Aricent IMS service is integrated with RIL for a VOLTE operator
    setprop aricent_ims_op_status 1
    # To Switch on VoLTE available
    setprop persist.dbg.volte_avail_ovr 1
    # To set IPV4 PCSCF address. This will be added by RIL.
    #setprop ril.ipv4.pcscf 172.16.103.75
    setprop ril.context.net.volte_available 1
    # Aricent Integration [END]

on fs
    mkdir /efs 0771 radio system
    mkdir /mnv 0771 radio system

    mount_all fstab.m86

    chown radio system /efs
    mkdir /efs/nv_data 0771 radio system
    #mkdir /mnv/nv_backup 0771 radio system
    #mount ext4 /dev/block/sda30 /efs/nv_backup ro
    setprop ro.crypto.fuse_sdcard true

# Boost Block I/O Performance
    write /sys/block/sda/queue/read_ahead_kb 1024
    write /sys/block/sda/queue/rq_affinity  2
    write /sys/block/sda/queue/iosched/slice_idle 0

# Permissions for ION
    chmod 0660 /sys/class/ion_cma/ion_video_ext/isolated
    chown system system /sys/class/ion_cma/ion_video_ext/isolated

# Permissions for backlight
    chmod 0660 /sys/class/backlight/pwm-backlight.0/brightness
    chown system system /sys/class/backlight/pwm-backlight.0/brightness

# FLYME:wangxiaoyong@SHELL.FlymeAutomaticBrightness.Feature {@
# Permissions for HBM
    chown system /sys/class/graphics/fb0/device/enterHBM
    chmod 0664 /sys/class/graphics/fb0/device/enterHBM
# @}

# Permissions for pwm led light
    chmod 0660 sys/class/leds/m86_led/brightness
    chown system system sys/class/leds/m86_led/brightness

# Copy DRM Key
    copy /system/app/wv.keys /factory/wv.keys

# Permission for DRM Key
    chmod 0644 /factory/wv.keys

    start adbd

# MobiCore startup
service mobicore /system/bin/mcDriverDaemon -r /system/app/mcRegistry/020a0000000000000000000000000000.drbin -r /system/app/mcRegistry/FFFFFFFFD00000000000000000000016.tlbin -r /system/app/mcRegistry/04020000000000000000000000000000.tlbin -r /system/app/mcRegistry/07020000000000000000000000000000.tlbin
    user system
    group system
    class main

# Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
#service watchdogd /sbin/watchdogd 10 20
#    class core
#    seclabel u:r:watchdogd:s0

# BRCM GPS
service gpsd /system/bin/gpsd -c /system/etc/gpsconfig.xml
    class late_start
    socket gps seqpacket 0660 gps system
    socket rilgps.socket seqpacket 0660 gps system
    user gps
    group system wakelock sdcard_rw inet root radio wifi

# for wifi related...
#service p2p_supplicant /system/bin/wpa_supplicant \
#    -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf \
#    -puse_p2p_group_interface=1p2p_device=1 \
#    -e/data/misc/wifi/entropy.bin \
#    -O/data/misc/wifi/sockets \
#    -g@android:wpa_wlan0

service p2p_supplicant /system/bin/wpa_supplicant \
    -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf \
    -I/system/etc/wifi/wpa_supplicant_overlay.conf  \
    -puse_p2p_group_interface=1p2p_device=1 \
    -m/data/misc/wifi/p2p_supplicant.conf \
    -e/data/misc/wifi/entropy.bin -g@android:wpa_wlan0
    #   we will start as root and wpa_supplicant will switch to user wifi
    #   after setting up the capabilities required for WEXT
    #   user wifi
    #   group wifi inet keystore
    class main
    socket wpa_wlan0 dgram 660 wifi wifi
    disabled
    group system wakelock
    oneshot

service wpa_supplicant /system/bin/wpa_supplicant \
    -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf -e/data/misc/wifi/entropy.bin \
    -O/data/misc/wifi/sockets \
    -g@android:wpa_wlan0
    #   we will start as root and wpa_supplicant will switch to user wifi
    #   after setting up the capabilities required for WEXT
    #   user wifi
    #   group wifi inet keystore
    class main
    socket wpa_wlan0 dgram 660 wifi wifi
    disabled
    group system wakelock
    oneshot

service wlan_write_otp system/bin/86_OTP.sh
    class main
    user root
    group root
    disabled
    oneshot

# Panic info dump
service record_panic /system/bin/record_panic_msg
    class main
    user root
    group radio cache inet misc audio sdcard_rw log sdcard_r
    oneshot

#service dis_effect /system/bin/dis_effect
#    class main
#    user system
#    group system
#    oneshot

 #ad reg op sock
service ad_daemon /system/bin/ad_daemon
    class main
    socket ad stream 666 system system

# logkit tools
service logkit /system/bin/logkit /sdcard/Android/log/  50  /mnt/shell/emulated
    class main
    user root
    group log system sdcard_r
    disabled
    oneshot

#on boot
    #start logkit

#on charger
#    start logkit

# Disable Booster -- BOBO
#service january_booster /system/bin/january_booster
#    class late_start

service march_hotplug /system/bin/march_hotplug
    class late_start

# on userdebug and eng builds, enable kgdb on the serial console
on property:ro.debuggable=1
    write /sys/module/kgdboc/parameters/kgdboc ttyFIQ1
    write /sys/module/fiq_debugger/parameters/kgdb_enable 1

on property:sys.make_bakdir=1
    chown radio system /mnv
    mkdir /mnv/bak 0771 radio system

on property:sys.rild_reset=1
    stop ril-daemon
    setprop sys.rild_reset 0
    start ril-daemon

# s333 modem ril service
service ril-daemon /system/bin/rild_exynos
    class main
    socket rild stream 660 root radio
    socket rild2 stream 660 root radio
    socket rild-debug stream 660 radio system
    socket rild2-debug stream 660 radio system
    user root
    group radio cache inet misc audio log
    onrestart restart cpboot-daemon

# Modem boot daemon
service cpboot-daemon /sbin/cbd -d
    class main
    user root
    group system
#    seclabel u:r:cbd:s0

# DM daemon
service DM-daemon /system/bin/dmd
    class main
    socket diag_stream stream 660 radio system
    user root
    group system
    seclabel u:r:dmd:s0

# VC daemon
service VC-daemon /system/bin/vcd
    class main
    socket app_stream stream 660 radio system
    user root
    group system
    seclabel u:r:vcd:s0

# SCE daemon
service SCE-daemon /system/bin/sced
    class main
    socket logdump stream 660 radio system
    user root
    group system
    seclabel u:r:sced:s0

## Aricent Integration [START] ##
# Aricent Setkey based IPSec daemon
service setkeydaemon /system/bin/setkeydaemon
    class main
    user root
    seclabel u:r:setkeydaemon:s0
    disabled
    oneshot
    on property:persist.ari.ims.setkeydaemon=enabled
    start setkeydaemon

    on property:persist.ari.ims.setkeydaemon=disabled
    stop setkeydaemon
## Aricent Integration [END] ##

#FLYME:liujianfeng@feature for tool of ap log{@
#service ro_log  /system/bin/log_test
#   class main
#   user root
#   group root system
#   disable

on property:persist.radio.aplog=1
    #start ro_log
    start logkit
on property:persist.radio.aplog=0
    #stop ro_log
    stop logkit
#@}

#FLYME:fanjun@SHELL.HapticFeedback.Feature {@
on init
    chown system system /dev/tspdrv
    chmod 0660 /dev/tspdrv

    mkdir /dev/pipes 0771 system system
    export VIBE_PIPE_PATH /dev/pipes

# fingerprint daemon
service fingerprintd /system/bin/fingerprintd
    class late_start
    user system

# TouchSense Player Service -- now minimally working without blob!
service openimmvibed /system/bin/openimmvibed
    class main
    user system
    group system
    oneshot

# TouchSense Player Service
service immvibed /system/bin/immvibed -p 99 -u 1000
    class main
    user root
    group root
    oneshot
#@}

